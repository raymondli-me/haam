<!DOCTYPE html>
<html>
<head>
    <title>HAAM Codebase Structure</title>
    <meta charset="utf-8">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            overflow: hidden;
        }
        #cy {
            width: 100vw;
            height: 100vh;
            background: #f5f5f5;
        }
        #info {
            position: absolute;
            top: 10px;
            right: 10px;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            max-width: 300px;
        }
        button {
            margin: 2px;
            padding: 5px 10px;
            cursor: pointer;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 4px;
        }
        button:hover {
            background: #2980b9;
        }
        .stats {
            margin-top: 10px;
            font-size: 14px;
        }
        .node-info {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #ddd;
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cytoscape/3.26.0/cytoscape.min.js"></script>
</head>
<body>
    <div id="cy"></div>
    <div id="info">
        <h2>HAAM Codebase Map</h2>
        <div>
            <button onclick="runLayout('cose')">Force Layout</button>
            <button onclick="runLayout('breadthfirst')">Tree Layout</button>
            <button onclick="runLayout('circle')">Circle Layout</button>
            <button onclick="runLayout('grid')">Grid Layout</button>
        </div>
        <div class="stats">
            <strong>Files:</strong> 40<br>
            <strong>Imports:</strong> 11<br>
            <strong>Lines:</strong> 19,156<br>
            <strong>Orphans:</strong> 27<br>
            <strong>Hubs:</strong> 1
        </div>
        <div class="node-info" id="node-info">
            <strong>Click a node for details</strong>
        </div>
    </div>
    
    <script>
        const nodes = [{"data": {"id": "analyze_codebase_better", "label": "analyze_codebase_better.py", "path": "analyze_codebase_better.py", "type": "script", "lines": 895, "functions": 19, "classes": 1, "color": "#2ecc71", "in_degree": 0, "out_degree": 0, "total_degree": 0}}, {"data": {"id": "analyze_codebase_final", "label": "analyze_codebase_final.py", "path": "analyze_codebase_final.py", "type": "script", "lines": 496, "functions": 14, "classes": 1, "color": "#2ecc71", "in_degree": 0, "out_degree": 0, "total_degree": 0}}, {"data": {"id": "colab_cell_criterion_ranking", "label": "colab_cell_criterion_ranking.py", "path": "colab_cell_criterion_ranking.py", "type": "script", "lines": 32, "functions": 0, "classes": 0, "color": "#2ecc71", "in_degree": 0, "out_degree": 0, "total_degree": 0}}, {"data": {"id": "examples_3d_pca_arrow_example", "label": "3d_pca_arrow_example.py", "path": "examples/3d_pca_arrow_example.py", "type": "example", "lines": 273, "functions": 8, "classes": 0, "color": "#95a5a6", "in_degree": 0, "out_degree": 1, "total_degree": 1}}, {"data": {"id": "examples_pc_umap_visualization_example", "label": "pc_umap_visualization_example.py", "path": "examples/pc_umap_visualization_example.py", "type": "example", "lines": 212, "functions": 5, "classes": 0, "color": "#95a5a6", "in_degree": 0, "out_degree": 1, "total_degree": 1}}, {"data": {"id": "examples_ranking_methods_example", "label": "ranking_methods_example.py", "path": "examples/ranking_methods_example.py", "type": "example", "lines": 63, "functions": 0, "classes": 0, "color": "#95a5a6", "in_degree": 0, "out_degree": 1, "total_degree": 1}}, {"data": {"id": "examples_simple_example", "label": "simple_example.py", "path": "examples/simple_example.py", "type": "example", "lines": 55, "functions": 0, "classes": 0, "color": "#95a5a6", "in_degree": 0, "out_degree": 1, "total_degree": 1}}, {"data": {"id": "examples_wordcloud_example", "label": "wordcloud_example.py", "path": "examples/wordcloud_example.py", "type": "example", "lines": 216, "functions": 6, "classes": 0, "color": "#95a5a6", "in_degree": 0, "out_degree": 1, "total_degree": 1}}, {"data": {"id": "examples_wordcloud_validity_example", "label": "wordcloud_validity_example.py", "path": "examples/wordcloud_validity_example.py", "type": "example", "lines": 186, "functions": 0, "classes": 0, "color": "#95a5a6", "in_degree": 0, "out_degree": 1, "total_degree": 1}}, {"data": {"id": "generate_codebase_viz", "label": "generate_codebase_viz.py", "path": "generate_codebase_viz.py", "type": "script", "lines": 606, "functions": 9, "classes": 1, "color": "#2ecc71", "in_degree": 0, "out_degree": 0, "total_degree": 0}}, {"data": {"id": "generate_wordclouds_nvembed", "label": "generate_wordclouds_nvembed.py", "path": "generate_wordclouds_nvembed.py", "type": "script", "lines": 285, "functions": 0, "classes": 0, "color": "#2ecc71", "in_degree": 0, "out_degree": 0, "total_degree": 0}}, {"data": {"id": "generate_wordclouds_nvembed_display", "label": "generate_wordclouds_nvembed_display.py", "path": "generate_wordclouds_nvembed_display.py", "type": "script", "lines": 321, "functions": 0, "classes": 0, "color": "#2ecc71", "in_degree": 0, "out_degree": 0, "total_degree": 0}}, {"data": {"id": "generate_wordclouds_validity_aligned", "label": "generate_wordclouds_validity_aligned.py", "path": "generate_wordclouds_validity_aligned.py", "type": "script", "lines": 577, "functions": 0, "classes": 0, "color": "#2ecc71", "in_degree": 0, "out_degree": 0, "total_degree": 0}}, {"data": {"id": "generate_wordclouds_validity_aligned_v2", "label": "generate_wordclouds_validity_aligned_v2.py", "path": "generate_wordclouds_validity_aligned_v2.py", "type": "script", "lines": 534, "functions": 0, "classes": 0, "color": "#2ecc71", "in_degree": 0, "out_degree": 0, "total_degree": 0}}, {"data": {"id": "generate_wordclouds_validity_enhanced", "label": "generate_wordclouds_validity_enhanced.py", "path": "generate_wordclouds_validity_enhanced.py", "type": "script", "lines": 522, "functions": 0, "classes": 0, "color": "#2ecc71", "in_degree": 0, "out_degree": 0, "total_degree": 0}}, {"data": {"id": "generate_wordclouds_validity_example", "label": "generate_wordclouds_validity_example.py", "path": "generate_wordclouds_validity_example.py", "type": "script", "lines": 232, "functions": 0, "classes": 0, "color": "#2ecc71", "in_degree": 0, "out_degree": 0, "total_degree": 0}}, {"data": {"id": "generate_wordclouds_validity_final_aligned", "label": "generate_wordclouds_validity_final_aligned.py", "path": "generate_wordclouds_validity_final_aligned.py", "type": "script", "lines": 533, "functions": 0, "classes": 0, "color": "#2ecc71", "in_degree": 0, "out_degree": 0, "total_degree": 0}}, {"data": {"id": "generate_wordclouds_validity_nvembed", "label": "generate_wordclouds_validity_nvembed.py", "path": "generate_wordclouds_validity_nvembed.py", "type": "script", "lines": 371, "functions": 0, "classes": 0, "color": "#2ecc71", "in_degree": 0, "out_degree": 0, "total_degree": 0}}, {"data": {"id": "generate_wordclouds_validity_simple", "label": "generate_wordclouds_validity_simple.py", "path": "generate_wordclouds_validity_simple.py", "type": "script", "lines": 368, "functions": 0, "classes": 0, "color": "#2ecc71", "in_degree": 0, "out_degree": 0, "total_degree": 0}}, {"data": {"id": "haam___init__", "label": "__init__.py", "path": "haam/__init__.py", "type": "package", "lines": 11, "functions": 0, "classes": 0, "color": "#9b59b6", "in_degree": 8, "out_degree": 0, "total_degree": 8}}, {"data": {"id": "haam_haam_bws", "label": "haam_bws.py", "path": "haam/haam_bws.py", "type": "core", "lines": 352, "functions": 11, "classes": 1, "color": "#3498db", "in_degree": 0, "out_degree": 0, "total_degree": 0}}, {"data": {"id": "haam_haam_init", "label": "haam_init.py", "path": "haam/haam_init.py", "type": "core", "lines": 1040, "functions": 20, "classes": 1, "color": "#3498db", "in_degree": 0, "out_degree": 0, "total_degree": 0}}, {"data": {"id": "haam_haam_package", "label": "haam_package.py", "path": "haam/haam_package.py", "type": "core", "lines": 1738, "functions": 23, "classes": 1, "color": "#3498db", "in_degree": 3, "out_degree": 0, "total_degree": 3}}, {"data": {"id": "haam_haam_setup", "label": "haam_setup.py", "path": "haam/haam_setup.py", "type": "core", "lines": 232, "functions": 0, "classes": 0, "color": "#3498db", "in_degree": 0, "out_degree": 0, "total_degree": 0}}, {"data": {"id": "haam_haam_topics", "label": "haam_topics.py", "path": "haam/haam_topics.py", "type": "core", "lines": 351, "functions": 6, "classes": 1, "color": "#3498db", "in_degree": 0, "out_degree": 0, "total_degree": 0}}, {"data": {"id": "haam_haam_usage_guide", "label": "haam_usage_guide.py", "path": "haam/haam_usage_guide.py", "type": "core", "lines": 387, "functions": 0, "classes": 0, "color": "#3498db", "in_degree": 0, "out_degree": 0, "total_degree": 0}}, {"data": {"id": "haam_haam_visualizations", "label": "haam_visualizations.py", "path": "haam/haam_visualizations.py", "type": "core", "lines": 2404, "functions": 16, "classes": 2, "color": "#3498db", "in_degree": 0, "out_degree": 0, "total_degree": 0}}, {"data": {"id": "haam_haam_visualizations_backup", "label": "haam_visualizations_backup.py", "path": "haam/haam_visualizations_backup.py", "type": "core", "lines": 2212, "functions": 16, "classes": 2, "color": "#3498db", "in_degree": 0, "out_degree": 0, "total_degree": 0}}, {"data": {"id": "haam_haam_wordcloud", "label": "haam_wordcloud.py", "path": "haam/haam_wordcloud.py", "type": "core", "lines": 819, "functions": 11, "classes": 1, "color": "#3498db", "in_degree": 0, "out_degree": 0, "total_degree": 0}}, {"data": {"id": "haam_haam_wordcloud_backup", "label": "haam_wordcloud_backup.py", "path": "haam/haam_wordcloud_backup.py", "type": "core", "lines": 658, "functions": 10, "classes": 1, "color": "#3498db", "in_degree": 0, "out_degree": 0, "total_degree": 0}}, {"data": {"id": "haam_wordcloud_aligned_patch", "label": "haam_wordcloud_aligned_patch.py", "path": "haam_wordcloud_aligned_patch.py", "type": "script", "lines": 398, "functions": 2, "classes": 0, "color": "#2ecc71", "in_degree": 0, "out_degree": 0, "total_degree": 0}}, {"data": {"id": "setup", "label": "setup.py", "path": "setup.py", "type": "setup", "lines": 64, "functions": 0, "classes": 0, "color": "#e74c3c", "in_degree": 0, "out_degree": 0, "total_degree": 0}}, {"data": {"id": "test_display", "label": "test_display.py", "path": "test_display.py", "type": "test", "lines": 24, "functions": 0, "classes": 0, "color": "#f39c12", "in_degree": 0, "out_degree": 1, "total_degree": 1}}, {"data": {"id": "test_display_direct", "label": "test_display_direct.py", "path": "test_display_direct.py", "type": "test", "lines": 39, "functions": 0, "classes": 0, "color": "#f39c12", "in_degree": 0, "out_degree": 1, "total_degree": 1}}, {"data": {"id": "test_final_verification", "label": "test_final_verification.py", "path": "test_final_verification.py", "type": "test", "lines": 43, "functions": 0, "classes": 0, "color": "#f39c12", "in_degree": 0, "out_degree": 1, "total_degree": 1}}, {"data": {"id": "test_model_outputs", "label": "test_model_outputs.py", "path": "test_model_outputs.py", "type": "test", "lines": 72, "functions": 0, "classes": 0, "color": "#f39c12", "in_degree": 0, "out_degree": 1, "total_degree": 1}}, {"data": {"id": "test_validity_coloring", "label": "test_validity_coloring.py", "path": "test_validity_coloring.py", "type": "test", "lines": 88, "functions": 0, "classes": 0, "color": "#f39c12", "in_degree": 0, "out_degree": 1, "total_degree": 1}}, {"data": {"id": "visualize_codebase", "label": "visualize_codebase.py", "path": "visualize_codebase.py", "type": "script", "lines": 684, "functions": 12, "classes": 1, "color": "#2ecc71", "in_degree": 0, "out_degree": 0, "total_degree": 0}}, {"data": {"id": "visualize_codebase_clean", "label": "visualize_codebase_clean.py", "path": "visualize_codebase_clean.py", "type": "script", "lines": 445, "functions": 3, "classes": 0, "color": "#2ecc71", "in_degree": 0, "out_degree": 0, "total_degree": 0}}, {"data": {"id": "visualize_codebase_simple", "label": "visualize_codebase_simple.py", "path": "visualize_codebase_simple.py", "type": "script", "lines": 318, "functions": 2, "classes": 0, "color": "#2ecc71", "in_degree": 0, "out_degree": 0, "total_degree": 0}}];
        const edges = [{"data": {"id": "examples_3d_pca_arrow_example_to_haam___init__", "source": "examples_3d_pca_arrow_example", "target": "haam___init__", "label": "from haam import ..."}}, {"data": {"id": "examples_pc_umap_visualization_example_to_haam___init__", "source": "examples_pc_umap_visualization_example", "target": "haam___init__", "label": "from haam import ..."}}, {"data": {"id": "examples_ranking_methods_example_to_haam___init__", "source": "examples_ranking_methods_example", "target": "haam___init__", "label": "from haam import ..."}}, {"data": {"id": "examples_simple_example_to_haam___init__", "source": "examples_simple_example", "target": "haam___init__", "label": "from haam import ..."}}, {"data": {"id": "examples_wordcloud_example_to_haam___init__", "source": "examples_wordcloud_example", "target": "haam___init__", "label": "from haam import ..."}}, {"data": {"id": "examples_wordcloud_validity_example_to_haam___init__", "source": "examples_wordcloud_validity_example", "target": "haam___init__", "label": "from haam import ..."}}, {"data": {"id": "test_display_to_haam___init__", "source": "test_display", "target": "haam___init__", "label": "from haam import ..."}}, {"data": {"id": "test_display_direct_to_haam_haam_package", "source": "test_display_direct", "target": "haam_haam_package", "label": "from haam.haam_package import ..."}}, {"data": {"id": "test_final_verification_to_haam_haam_package", "source": "test_final_verification", "target": "haam_haam_package", "label": "from haam.haam_package import ..."}}, {"data": {"id": "test_model_outputs_to_haam_haam_package", "source": "test_model_outputs", "target": "haam_haam_package", "label": "from haam.haam_package import ..."}}, {"data": {"id": "test_validity_coloring_to_haam___init__", "source": "test_validity_coloring", "target": "haam___init__", "label": "from haam import ..."}}];
        
        console.log('Loading', nodes.length, 'nodes and', edges.length, 'edges');
        
        const cy = cytoscape({
            container: document.getElementById('cy'),
            elements: {
                nodes: nodes,
                edges: edges
            },
            style: [
                {
                    selector: 'node',
                    style: {
                        'label': 'data(label)',
                        'background-color': 'data(color)',
                        'text-valign': 'bottom',
                        'text-halign': 'center',
                        'font-size': '10px',
                        'width': ele => Math.max(30, Math.min(80, Math.sqrt(ele.data('lines') || 50) * 3)),
                        'height': ele => Math.max(30, Math.min(80, Math.sqrt(ele.data('lines') || 50) * 3))
                    }
                },
                {
                    selector: 'edge',
                    style: {
                        'width': 2,
                        'line-color': '#999',
                        'target-arrow-color': '#999',
                        'target-arrow-shape': 'triangle',
                        'curve-style': 'bezier',
                        'label': 'data(label)',
                        'font-size': '8px',
                        'text-rotation': 'autorotate'
                    }
                },
                {
                    selector: ':selected',
                    style: {
                        'background-color': '#ff0000',
                        'line-color': '#ff0000',
                        'target-arrow-color': '#ff0000'
                    }
                }
            ],
            layout: {
                name: 'cose',
                animate: true
            }
        });
        
        // Event handlers
        cy.on('tap', 'node', function(evt) {
            const node = evt.target;
            const data = node.data();
            
            document.getElementById('node-info').innerHTML = `
                <strong>${data.label}</strong><br>
                Type: ${data.type}<br>
                Path: ${data.path}<br>
                Lines: ${data.lines || 0}<br>
                Imports: ${data.out_degree || 0}<br>
                Imported by: ${data.in_degree || 0}
            `;
        });
        
        function runLayout(name) {
            cy.layout({ name: name, animate: true }).run();
        }
        
        // Fit on load
        cy.ready(() => {
            cy.fit();
        });
    </script>
</body>
</html>